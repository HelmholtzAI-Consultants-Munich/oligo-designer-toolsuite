#######################
### BASIC PARAMETERS ###
#######################

### General parameters
n_jobs: 4 # number of cores used to run the pipeline
dir_output: output_primer_designer # name of the directory where the output files will be written
write_intermediate_steps: true # if true, writes the oligo sequences after each step of the pipeline into a csv file

### Parameters for sequences generation
# Forward primer
f_primer_sequence_probs:
  A: 25
  G: 25
  C: 25
  T: 25
f_primer_length: 20

# Reverse primer
r_primer_sequence: TAATACGACTCACTATAGGG # T7 promoter sequence

### Parameters for the property filers, i.e. properties that the sequences should fulfill
# Forward primer
f_primer_GC_content_min: 50 # minimum GC content of forward primer
f_primer_GC_content_max: 65 # maximum GC content of forward primer
f_primer_GC_clamp_n_bases: 2 # The number of bases from the 3' end of the sequence to check for the presence of G or C.
f_primer_GC_clamp_nGC: 1 # The minimum number of G or C bases at the 3' end.
f_primer_Tm_min: 60 # minimum melting temperature of forward primer
f_primer_Tm_max: 65 # maximum melting temperature of forward primer
f_primer_homopolymeric_base_n: # minimum number of nucleotides to consider it a homopolymeric run per base
  A: 3
  T: 3
  C: 3
  G: 3
f_primer_3_prime_sequence: T # sequence that shouldn't be at the 3' end of the forward primer
f_primer_T_secondary_structure: 76 # Temperature at which the free energy is calculated


### Parameters for the specificity filters
f_primer_files_fasta_reference_database: # fasta file with sequences used as reference for the specificity filters. Hint: use the genomic_region_generator pipeline to create fasta files of genomic regions of interest
  - data/genomic_regions/exon_annotation_source-NCBI_species-Homo_sapiens_annotation_release-110_genome_assemly-GRCh38.fna
  - data/genomic_regions/exon_exon_junction_annotation_source-NCBI_species-Homo_sapiens_annotation_release-110_genome_assemly-GRCh38.fna


### Parameters for the Oligo set selection
probe_Tm_opt: 62.6 # Tm of t7 primer (one could calculate it from the reverse primer directly?)

############################
### ADVANCED PARAMETERS ###
############################

### Parameters for the specificity filters
# Specificity filter with BlastN
specificity_blastn_search_parameters:
  perc_identity: 80
  strand: "minus" # this parameter is fixed, if reference is whole genome, consider using "both"
  word_size: 7
  dust: "no"
  soft_masking: "false"
  max_target_seqs: 10
  max_hsps: 1000
specificity_blastn_hit_parameters:
  coverage: 70 # can be turned into min_alignment_length
  # min_alignment_length: 14


specificity_blastn_search_parameters_encoding_probe:
  perc_identity: 80
  strand: "minus" # this parameter is fixed, if reference is whole genome, consider using "both"
  word_size: 7
  dust: "no"
  soft_masking: "false"
  max_target_seqs: 10
  max_hsps: 1000
specificity_blastn_hit_parameters_encoding_probe:
  coverage: 55 # can be turned into min_alignment_length
  # min_alignment_length: 11

# Crosshybridization filter with BlastN
cross_hybridization_blastn_search_parameters_T7:
  perc_identity: 80
  strand: "minus" # this parameter is fixed
  word_size: 7
  dust: "no"
  soft_masking: "false"
  max_target_seqs: 10
cross_hybridization_blastn_hit_parameters_T7:
  coverage: 25 # can be turned into min_alignment_length
  # min_alignment_length: 5


### Parameters for the Oligo set selection
max_graph_size: 5000 # maximum number of oligos that are taken into consisderation in the last step (5000 -> ~5GB, 2500 -> ~1GB)


### Parameters for Melting Temperature
# The melting temperature is used in 2 different stages (property filters and padlock detection probe design), where a few parameters are shared and the others differ.
# parameters for melting temperature -> for more information on parameters, see: https://biopython.org/docs/1.75/api/Bio.SeqUtils.MeltingTemp.html#Bio.SeqUtils.MeltingTemp.Tm_NN
Tm_parameters_probe:
    check: true #default
    strict: true #default
    c_seq: null #default
    shift: 0 #default
    nn_table: DNA_NN4 # Moffitt (2016)
    tmm_table: DNA_TMM1 #default
    imm_table: DNA_IMM1 #default
    de_table: DNA_DE1 #default
    dnac1: 500 #[nM] taken from repo
    dnac2: 0 #[nM]
    selfcomp: false #default
    saltcorr: 5 # Correction for deltaS, taken from repo
    Na: 300 #[mM], 0.3M, taken from repo
    dNTPs: 0 #[mM] default
